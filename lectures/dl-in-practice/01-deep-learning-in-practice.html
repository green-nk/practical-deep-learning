<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="green-nk">

<title>Practical Deep Learning for Coders - Whatelse to know to deep learning in practice?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../projects/horapa-vs-kaprao.html" rel="next">
<link href="../../lectures/dl-in-practice/01-pre-trained-model.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": "tree",
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Lectures</li><li class="breadcrumb-item"><a href="../../lectures/dl-in-practice/01-pre-trained-model.html">DL in practice</a></li><li class="breadcrumb-item"><a href="../../lectures/dl-in-practice/01-deep-learning-in-practice.html">Whatelse to know to deep learning in practice?</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Practical Deep Learning for Coders</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/green-nk/practical-deep-learning" title="Source code" class="quarto-navigation-tool px-1" aria-label="Source code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practical Deep Learning</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">DL in practice</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/dl-in-practice/01-pre-trained-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Is it a bird? — The power of pretrained-model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/dl-in-practice/01-deep-learning-in-practice.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Whatelse to know to deep learning in practice?</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/horapa-vs-kaprao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Is it actually holy basil?</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../CHANGELOG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Changelog</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#why-deep-learning" id="toc-why-deep-learning" class="nav-link" data-scroll-target="#why-deep-learning">Why Deep Learning?</a></li>
  <li><a href="#neural-networks-a-brief-history" id="toc-neural-networks-a-brief-history" class="nav-link" data-scroll-target="#neural-networks-a-brief-history">Neural Networks: A Brief History</a></li>
  <li><a href="#cats-and-dogs" id="toc-cats-and-dogs" class="nav-link" data-scroll-target="#cats-and-dogs">Cats and Dogs</a></li>
  </ul></li>
  <li><a href="#what-is-machine-learning" id="toc-what-is-machine-learning" class="nav-link" data-scroll-target="#what-is-machine-learning">What Is Machine Learning?</a>
  <ul class="collapse">
  <li><a href="#what-is-a-neural-network" id="toc-what-is-a-neural-network" class="nav-link" data-scroll-target="#what-is-a-neural-network">What Is a Neural Network?</a></li>
  <li><a href="#tips-and-tricks" id="toc-tips-and-tricks" class="nav-link" data-scroll-target="#tips-and-tricks">Tips and Tricks</a></li>
  </ul></li>
  <li><a href="#deep-learning-is-not-just-for-image-classification" id="toc-deep-learning-is-not-just-for-image-classification" class="nav-link" data-scroll-target="#deep-learning-is-not-just-for-image-classification">Deep Learning Is Not Just for Image Classification</a>
  <ul class="collapse">
  <li><a href="#image-segmentation" id="toc-image-segmentation" class="nav-link" data-scroll-target="#image-segmentation">Image Segmentation</a></li>
  <li><a href="#sentiment-classification" id="toc-sentiment-classification" class="nav-link" data-scroll-target="#sentiment-classification">Sentiment Classification</a></li>
  <li><a href="#tabular-data" id="toc-tabular-data" class="nav-link" data-scroll-target="#tabular-data">Tabular Data</a></li>
  <li><a href="#recommendation-system" id="toc-recommendation-system" class="nav-link" data-scroll-target="#recommendation-system">Recommendation System</a></li>
  </ul></li>
  <li><a href="#questionnaire" id="toc-questionnaire" class="nav-link" data-scroll-target="#questionnaire">Questionnaire</a>
  <ul class="collapse">
  <li><a href="#further-research" id="toc-further-research" class="nav-link" data-scroll-target="#further-research">Further Research</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Lectures</li><li class="breadcrumb-item"><a href="../../lectures/dl-in-practice/01-pre-trained-model.html">DL in practice</a></li><li class="breadcrumb-item"><a href="../../lectures/dl-in-practice/01-deep-learning-in-practice.html">Whatelse to know to deep learning in practice?</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Whatelse to know to deep learning in practice?</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>green-nk </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Mar 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Disclaimer</div>
    This page was run by Google Colab and documented with Quarto. Objective of it is to get a first hands-on ML/DL using fastai.
  </div>
</div>


</header>


<p><a href="https://colab.research.google.com/github/green-nk/practical-deep-learning/blob/main/is-it-a-bird%3F-pre-trained-model.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>First, we need to setup an access to <em>Google Drive</em>. This is to persist data or artifacts in a local drive even when we are not connected to <em>Google Colab</em>.</p>
<div id="cell-3" class="cell" data-outputid="c7d89143-6605-4436-c785-eb88bff8dcb7" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">"/content/gdrive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mounted at /content/gdrive</code></pre>
</div>
</div>
<p>Then, install <code>ipywidgets</code> and <code>fastai</code> as necessary dependencies and import them.</p>
<div id="cell-5" class="cell" data-outputid="750a6ff2-622c-4022-87a5-7f5d4a20d4f2" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m pip install <span class="op">-</span>Uqq ipywidgets fastai</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 139.4/139.4 kB 1.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 12.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 16.3 MB/s eta 0:00:00</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.text.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.collab <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<section id="why-deep-learning" class="level3">
<h3 class="anchored" data-anchor-id="why-deep-learning">Why Deep Learning?</h3>
<p>This is a starting point to your deep learning journey. Before we dive into what you need to know about it and how, it is important to talk about <strong>Why?</strong>.</p>
<ul>
<li><strong>It is for everyone:</strong> One might say deep learning is like a blackbox. However, the truth is in practice, what you want to do is just to solve problem of your own interests and there are a lot of state-of-the-art models to help you do that.</li>
<li><strong>Huge amount of data:</strong> A lot of open-source and pre-trained model out there! So, there is no need for you to start collecting data from scratch just a few samples of it.</li>
<li><strong>High computational resources:</strong> You do not need to be <em>Google</em> or <em>Microsoft</em> to train such large models. Nowadays, everyone can access this kind of computational resouce for free.</li>
<li><strong>Good for thousands of use cases in different areas:</strong> There are remarkable accomplishment throughout the recent years that deep learning helps researchers and practitioners solve. Here is some of them:
<ul>
<li>Natural language processing (NLP): answering questions; speech recognition; summarizing documents; classifying documents; translation;information retrieval (searching). Here is my recommendation on <a href="https://www.deeplearning.ai/resources/natural-language-processing/">a comprehensive guide to NLP</a>.</li>
<li>Computer vision: image recognition; image captioning; object detection; image segmentation; image generation.</li>
<li>Recommendation systems: product recommendations; web searching.</li>
<li>Games: chess; go; real-time strategy games like StarCrafts.</li>
<li>Others: algoritmic trading; text-to-speech.</li>
</ul></li>
</ul>
</section>
<section id="neural-networks-a-brief-history" class="level3">
<h3 class="anchored" data-anchor-id="neural-networks-a-brief-history">Neural Networks: A Brief History</h3>
<p>This is a simplified verison of ANNs history that you will help you contextualize on what we have been through and learn to not repeat some of it!</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR;
    A[Artificial Neurons] -- Unrecognized social position --&gt; B[Perceptrons] -- Failure to learn simple XOR --&gt; C[PDP] -- Approximation with one extra layer --&gt; D[Modern ANNs];
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Basically, what researchers have tried to do since 1943 is to develop a mathematical model of an artificial neuron inspired by the human brain. Although there are several years of misunderstanding of the theoretical issues, we still have multi-volume Parallel Distributed Processing (PDP) which acts as a backbone of modern ANNs. Here is the required components for this framework:</p>
<ol type="1">
<li>A set of processing units</li>
<li>A state of activation</li>
<li>An output function for each unit</li>
<li>A pattern of connectivity among units</li>
<li>A propagation rule for propagating patterns of activities through the network of connectivities</li>
<li>An activation rule for combining the inputs impinging on a unit with the current state of that unit to produce an output for the unit</li>
<li>A learning rule whereby patterns of connectivity are modified by experience</li>
<li>An environment within which the system must operate</li>
</ol>
<p>Again, thanks to the use of more layers, together with the improvement in hardware capability, the increase amount of data and algorithmic tweaks that allow neural networks to be trained faster and more easily, We now are able to complete complex tasks like an image recognizer by a only computer.</p>
</section>
<section id="cats-and-dogs" class="level3">
<h3 class="anchored" data-anchor-id="cats-and-dogs">Cats and Dogs</h3>
<p>Let’s implement <em>PDP</em> framework in practice by using a <em>pre-trained model</em> to complete a task; an image recognizer perhaps. Here is what about to happen:</p>
<ol type="1">
<li>A dataset called the <a href="http://www.robots.ox.ac.uk/~vgg/data/pets/">Oxford-IIIT Pet Dataset</a> that contains 7,349 images of cats and dogs from 37 different breeds will be downloaded from the fast.ai datasets collection to the GPU server you are using, and will then be extracted.</li>
<li>A <em>pretrained model</em> that has already been trained on 1.3 million images, using a competition-winning model will be downloaded from the internet.</li>
<li>The pretrained model will be <em>fine-tuned</em> using the latest advances in transfer learning, to create a model that is specially customized for recognizing dogs and cats.</li>
</ol>
<div id="cell-11" class="cell" data-outputid="ea4fd7fb-a40a-48b8-c50b-c8fd3a97b1c1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">'images'</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>is_cat <span class="op">=</span> <span class="kw">lambda</span> x: x[<span class="dv">0</span>].isupper()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    path, get_image_files(path), valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    label_func<span class="op">=</span>is_cat, item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet34, metrics<span class="op">=</span>error_rate)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="811712512" class="" max="811706944" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [811712512/811706944 00:59&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading: "https://download.pytorch.org/models/resnet34-b627a593.pth" to /root/.cache/torch/hub/checkpoints/resnet34-b627a593.pth
100%|██████████| 83.3M/83.3M [00:00&lt;00:00, 90.6MB/s]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.163383</td>
<td>0.030820</td>
<td>0.012179</td>
<td>00:48</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.055516</td>
<td>0.037565</td>
<td>0.012855</td>
<td>01:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Depending on your network speed, it might take a few minutes to download the pretrained model and dataset. Running <code>fine_tune</code> might take a minute or so. Often models in this book take a few minutes to train, as will your own models, so it’s a good idea to come up with good techniques to make the most of this time. For instance, keep reading the next section while training your model, or open up another notebook and use it for some coding experiments.</p>
</div>
</div>
<p>After we have trained the model, we need to check if it can do something useful right? There are several ways we can do. The first way is to create an uploader for an interaction. This way is the simplest and suitable for users similiarized with <em>GUI</em>.</p>
<div id="cell-14" class="cell" data-outputid="3fee7a21-0606-4848-a7ff-f4cc0ab39722">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> FileUpload</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This should prompt a uploader UI for file attachment</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>uploader <span class="op">=</span> FileUpload()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>uploader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"20758989546a4aa2a7a6ebdedc449bff","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>Or you can just past in a download link to <code>download_image</code> function provided by <code>fastai</code> library.</p>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dest <span class="op">=</span> Path(<span class="st">"gdrive/My Drive/practical-deep-learning/bin/"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>download_images(dest, urls<span class="op">=</span>[<span class="st">"https://i.icanvas.com/COC490?d=3&amp;sh=v&amp;s=xl&amp;p=1&amp;bg=g&amp;t=1648830566"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell" data-outputid="c116032f-7993-42b3-b819-e961eeac50fa">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> PILImage.create(<span class="st">"/content/gdrive/MyDrive/practical-deep-learning/bin/75083824-ac57-46d2-acdb-2e0678aba62f.jpg"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>img.to_thumb(<span class="dv">224</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<figure class="figure">
<p><img src="01-deep-learning-in-practice_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-outputid="24aab50d-1b2d-4e59-c2b3-2400b13fd846">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>is_cat, _, probs <span class="op">=</span> learn.predict(img)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Is this a cat?: </span><span class="sc">{</span>is_cat<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability it's a cat: </span><span class="sc">{</span>probs[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>Is this a cat?: False.
Probability it's a cat: 0.0357</code></pre>
</div>
</div>
<p>As you can see, the model can correctly classify even an image has some part that is not a dog! This is the power of a pre-trained model.</p>
<p>But what does it actually doing? we will have a look more closer into the code.</p>
<section id="how-our-image-recognizer-works" class="level4">
<h4 class="anchored" data-anchor-id="how-our-image-recognizer-works">How Our Image Recognizer works</h4>
<p>Let’s look through the code first.</p>
<p><code>untar_data</code> function has downloaded a standardard dataset from the <a href="https://course.fast.ai/datasets">fast.ai datasets collection</a> (if not previously downloaded) to your server, extracts it (if not previously extracted), and returns a <code>Path</code> object with the extracted location:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">'images'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Next, we define a function, <code>is_cat</code>, which labels cats based on a filename rule provided by the dataset creators:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>is_cat <span class="op">=</span> <span class="kw">lambda</span> x: x[<span class="dv">0</span>].isupper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, we need to tell <code>fastai</code> what kind of dataset we have and how it is structured:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    path, get_image_files(path), valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    label_func<span class="op">=</span>is_cat, item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There are various different classes for different kinds of deep learning datasets and problems—here we’re using <code>ImageDataLoaders</code>. The first part of the class name will generally be the type of data you have, such as image, or text.</p>
<p>The other important piece of information that we have to tell <code>fastai</code> is how to get the labels from the dataset. Computer vision datasets are normally structured in such a way that the label for an image is part of the filename, or path—most commonly the parent folder name. fastai comes with a number of standardized labeling methods, and ways to write your own. Here we’re telling fastai to use the <code>is_cat</code> function we just defined.</p>
<p>Finally, we define the <code>Transform</code>s that we need. A <code>Transform</code> contains code that is applied automatically during training; fastai includes many predefined <code>Transform</code>s, and adding new ones is as simple as creating a Python function. There are two kinds: <code>item_tfms</code> are applied to each item (in this case, each item is resized to a 224-pixel square), while <code>batch_tfms</code> are applied to a <em>batch</em> of items at a time using the GPU, so they’re particularly fast!</p>
<p>Why 224 pixels? This is the standard size for historical reasons (old pretrained models require this size exactly), but you can pass pretty much anything. If you increase the size, you’ll often get a model with better results (since it will be able to focus on more details), but at the price of speed and memory consumption; the opposite is true if you decrease the size.</p>
<p>The Pet dataset contains 7,390 pictures of dogs and cats, consisting of 37 different breeds. Each image is labeled using its filename: for instance the file <em>great_pyrenees_173.jpg</em> is the 173rd example of an image of a Great Pyrenees breed dog in the dataset. The filenames start with an uppercase letter if the image is a cat, and a lowercase letter otherwise. We have to tell <code>fastai</code> how to get labels from the filenames, which we do by calling <code>from_name_func</code> (which means that labels can be extracted using a function applied to the filename), and passing <code>is_cat</code>, which returns <code>x[0].isupper()</code>, which evaluates to <code>True</code> if the first letter is uppercase (i.e., it’s a cat).</p>
<p>The most important parameter to mention here is <code>valid_pct=0.2</code>. This tells <code>fastai</code> to hold out 20% of the data and <em>not use it for training the model at all</em>. This 20% of the data is called the <em>validation set</em>; the remaining 80% is called the <em>training set</em>. The validation set is used to measure the accuracy of the model. By default, the 20% that is held out is selected randomly. The parameter <code>seed=42</code> sets the <em>random seed</em> to the same value every time we run this code, which means we get the same validation set every time we run it—this way, if we change our model and retrain it, we know that any differences are due to the changes to the model, not due to having a different random validation set.</p>
<p>Next, it tells `<code>fastai</code> to create a <em>convolutional neural network</em> (CNN) and specifies what <em>architecture</em> to use (i.e.&nbsp;what kind of model to create), what data we want to train it on, and what <em>metric</em> to use:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet34, metrics<span class="op">=</span>error_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Why a CNN? It’s the current state-of-the-art approach to creating computer vision models. Their structure is inspired by how the human vision system works.</p>
<p>There are many different architectures in <code>fastai</code>, which we will introduce in the later lecture (as well as discussing how to create your own). Most of the time, however, picking an architecture isn’t a very important part of the deep learning process. It’s something that academics love to talk about, but in practice it is unlikely to be something you need to spend much time on. There are some standard architectures that work most of the time, and in this case we’re using one called <em>ResNet</em> that we’ll be talking a lot about during the book; it is both fast and accurate for many datasets and problems. The <code>34</code> in <code>resnet34</code> refers to the number of layers in this variant of the architecture (other options are <code>18</code>, <code>50</code>, <code>101</code>, and <code>152</code>). Models using architectures with more layers take longer to train, and are more prone to overfitting (i.e.&nbsp;you can’t train them for as many epochs before the accuracy on the validation set starts getting worse). On the other hand, when using more data, they can be quite a bit more accurate.</p>
<p>What is a metric? A <em>metric</em> is a function that measures the quality of the model’s predictions using the validation set, and will be printed at the end of each <em>epoch</em>. In this case, we’re using <code>error_rate</code>, which is a function provided by <code>fastai</code> that does just what it says: tells you what percentage of images in the validation set are being classified incorrectly. Another common metric for classification is <code>accuracy</code> (which is just <code>1.0 - error_rate</code>). There are many more to cover in the later lecture.</p>
<p>The concept of a metric may remind you of <em>loss</em>, but there is an important distinction. The entire purpose of loss is to define a “measure of performance” that the training system can use to update weights automatically. In other words, a good choice for loss is a choice that is easy for stochastic gradient descent to use. But a metric is defined for human consumption, so a good metric is one that is easy for you to understand, and that hews as closely as possible to what you want the model to do. At times, you might decide that the loss function is a suitable metric, but that is not necessarily the case.</p>
<p><code>vision_learner</code> also has a parameter <code>pretrained</code>, which defaults to <code>True</code> (so it’s used in this case, even though we haven’t specified it), which sets the weights in your model to values that have already been trained by experts to recognize a thousand different categories across 1.3 million photos (using the famous <a href="http://www.image-net.org/"><em>ImageNet</em> dataset</a>). A model that has weights that have already been trained on some other dataset is called a <em>pretrained model</em>. You should nearly always use a pretrained model, because it means that your model, before you’ve even shown it any of your data, is already very capable. And, as you’ll see, in a deep learning model many of these capabilities are things you’ll need, almost regardless of the details of your project. For instance, parts of pretrained models will handle edge, gradient, and color detection, which are needed for many tasks.</p>
<p>When using a pretrained model, <code>vision_learner</code> will remove the last layer, since that is always specifically customized to the original training task (i.e.&nbsp;ImageNet dataset classification), and replace it with one or more new layers with randomized weights, of an appropriate size for the dataset you are working with. This last part of the model is known as the <em>head</em>.</p>
<p>Using pretrained models is the <em>most</em> important method we have to allow us to train more accurate models, more quickly, with less data, and less time and money. You might think that would mean that using pretrained models would be the most studied area in academic deep learning… but you’d be very, very wrong! The importance of pretrained models is generally not recognized or discussed in most courses, books, or software library features, and is rarely considered in academic papers.</p>
<p>Using a pretrained model for a task different to what it was originally trained for is known as <em>transfer learning</em>. Unfortunately, because transfer learning is so under-studied, few domains have pretrained models available. For instance, there are currently few pretrained models available in medicine, making transfer learning challenging to use in that domain. In addition, it is not yet well understood how to use transfer learning for tasks such as time series analysis.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Transfer learning: using a pretrained model for a task different to what it was originally trained for.</p>
</div>
</div>
<p>Here comes our training part. Our code tells <code>fastai</code> how to <em>fit</em> the model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As we’ve discussed, the architecture only describes a <em>template</em> for a mathematical function; it doesn’t actually do anything until we provide values for the millions of parameters it contains.</p>
<p>This is the key to deep learning—determining how to fit the parameters of a model to get it to solve your problem. In order to fit a model, we have to provide at least one piece of information: how many times to look at each image (known as number of <em>epochs</em>). The number of epochs you select will largely depend on how much time you have available, and how long you find it takes in practice to fit your model. If you select a number that is too small, you can always train for more epochs later.</p>
<p>But why is the method called <code>fine_tune</code>, and not <code>fit</code>? <code>fastai</code> actually <em>does</em> have a method called <code>fit</code>, which does indeed fit a model (i.e.&nbsp;look at images in the training set multiple times, each time updating the parameters to make the predictions closer and closer to the target labels). But in this case, we’ve started with a pretrained model, and we don’t want to throw away all those capabilities that it already has. There are some important tricks that we are going to learn throughout the course to adapt a pretrained model for a new dataset — a process called <em>fine-tuning</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fine-tuning: a transfer learning technique where the parameters of a pretrained model are updated by training for additional epochs using a similar task and dataset.</p>
</div>
</div>
<p>When you use the <code>fine_tune</code> method, <code>fastai</code> will use these tricks for you. There are a few parameters you can set (which we’ll discuss later), but in the default form shown here, it does two steps:</p>
<ol type="1">
<li>Use one epoch to fit just those parts of the model necessary to get the new random head to work correctly with your dataset.</li>
<li>Use the number of epochs requested when calling the method to fit the entire model, updating the weights of the later layers (especially the head) faster than the earlier layers (which, as we’ll see, generally don’t require many changes from the pretrained weights).</li>
</ol>
<p>The <em>head</em> of a model is the part that is newly added to be specific to the new dataset. An <em>epoch</em> is one complete pass through the dataset. After calling <code>fit</code>, the results after each epoch are printed, showing the epoch number, the training and validation set losses (the “measure of performance” used for training the model), and any <em>metrics</em> you’ve requested (error rate, in this case).</p>
</section>
<section id="whar-our-image-recognizer-learned" class="level4">
<h4 class="anchored" data-anchor-id="whar-our-image-recognizer-learned">Whar Our Image Recognizer Learned</h4>
<p>Before going to the next section, we have already know what our code has been doing. That’s good!</p>
<p>But intuition behind it, it also important for you as there is the key you can use to adapt this code to any kind of problems.</p>
<p>In 2013 a PhD student, Matt Zeiler, and his supervisor, Rob Fergus, published the paper <a href="https://arxiv.org/pdf/1311.2901.pdf">“Visualizing and Understanding Convolutional Networks”</a>, which showed how to visualize the neural network weights learned in each layer of a model. They carefully analyzed the model that won the 2012 ImageNet competition, and used this analysis to greatly improve the model, such that they were able to go on to win the 2013 competition!</p>
<p>You can see pictures of each layer in their paper. So, I am going to summarize here:</p>
<blockquote class="blockquote">
<p>As the layer go deeper, the model learns more sophiticated features.</p>
</blockquote>
<p>This statement provides an inspiration to what neural networks do in what so called the “blackbox”. Also, it is a confirmation that neural networks themselves have the ability to learn feature on theirown. This gives us a lot of potential:</p>
<ul>
<li>We do not need <em>hand-crafted features</em> and preserve the nature of dataset.</li>
<li>Flexibility on how to use the neural networks on every possible data format that you can imagine.</li>
</ul>
</section>
</section>
</section>
<section id="what-is-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="what-is-machine-learning">What Is Machine Learning?</h2>
<p>Now that we have learn deep learning through hands-on exercise, It is time to dig a lit bit deeper into it. We will start with <em>Machine Learning</em>.</p>
<p>This term is like a primitive to <em>Deep Learning</em>. What is means is that it is another paradiagm (as opposed to <em>Traditional Programming</em>) to get computers to complete a specific task. The key difference is here:</p>
<blockquote class="blockquote">
<p>ML provides an ability for a computer to learn without explitcitly being programmed</p>
</blockquote>
<p>Here is <a href="https://vas3k.com/blog/machine_learning/">an introduction to machine learning</a> that I find easily to get started. This blog includes the main concepts and its real-world examples.</p>
<p>Now, back to business, the basic of every traditional program should look like this:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR;
    A([inputs]) --&gt; B[program] --&gt; C([results]);
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>However, for tasks like image recognition. It is almost impossible for you as a programmer who write an <em>instruction</em> to turn <em>inputs</em> into <em>results</em> as we are human that can do it unconsciouly. Therefore, the new paradiagm to the problem comes in. <strong>Machine Learning</strong> seem like a good way to solve the problem but in reality how can we implement it.</p>
<p>Remember <em>PDP</em> framework? we need various components for a computer to utilize in order to acheive our goal. The concepts like “weight assignment” and “performance evaluation” have emerged though it is crucial for a computer to do it automatically. So, we also need some <strong>mechanism</strong> to provide the ability to automate the process of improvement and make sure that the model can do whatever it is required to do. Here is the summary of what it should be look like:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR;
    A([inputs]) --&gt; C[model];
    B([weights]) --&gt; C[model];
    C[model] --&gt; D([results]);
    D([results]) --&gt; E([performance]);
    E([performance]) -- update --&gt; B([weights]);
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Such <strong>mechanism</strong> keep the model going toward perfection as it iteratively update weights. Also note that once the model is finished training, the weight themselves act as a part of the model.</p>
<p>So, the simplfied version of it would be something which quite similar to what traditional programming is:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR;
    A([inputs]) --&gt; B[model] --&gt; C([results]);
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<section id="what-is-a-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-neural-network">What Is a Neural Network?</h3>
<p><em>Neural Network</em> is just another algorithm for <em>Machine Learning</em> like <em>Random Forest</em> or <em>Gradient Boosting</em> and that’s it! That is a neural network in a nutshell.</p>
<p>Although neural network seems very complex, the beginning of it is quite intuitive as it is inspired by the human brain cells using a mathematical function and it turns out to be a very powerful and flexible function which depends only on its weights. A mathematical proof called the <em>universal approximation theorem</em> shows that this function can solve any problem to any level of accuracy, in theory.</p>
<p>However, in practice there are many caveats to it like the quality of dataset, the hardware computation used to run those neural networks or the trade-off between time and cost of big networks.</p>
<p>Nowadays, the term <em>Deep Learning</em> has replaced <em>Neural Network</em> as nobody build a couple layers of the network anymore. People tends to go <strong>deeper</strong> like the name suggested. Thanks to its graph-like nature, it is still quickly understandable through visual representation and great resources online help practitioner a lot in doing so.</p>
<p>Alright but here comes the question — if we have such a good template or so called “architecture” let say a very deep one, then how we are going to train it? how we know that it is optimized with the correct set of weights?</p>
<p>The answer is we need a <strong>mechanism</strong> like in traditional machine learning. But in deep learning, this mechanism is called <em>stochastic gradient descent</em> (SGD). Unlike in the traditional machine learning, SGD is also very flexible and can be used to update weights in every architectures that we can imagine. Here is a process looks like:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR;
    A([inputs]) --&gt; C[architecture];
    B([parameters]) --&gt; C[architecture];
    C[architecture] --&gt; D([predictions]);
    D([predictions]) --&gt; E([loss]);
    E([loss]) -- update --&gt; B([parameters]);
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>As you can see, although we use different terminologies, they are basically the same. The only thing I need to point out is in deep learning, we use SGD to optimize our model parameters.</p>
</section>
<section id="tips-and-tricks" class="level3">
<h3 class="anchored" data-anchor-id="tips-and-tricks">Tips and Tricks</h3>
<p>In machine learning, of course it has a limitation but this should not stop you and I will tell you the important tips and tricks on how to handle it and provide you with an inspiration of its potential so that you will have a solid foundation to be able to complete any task that you are interested in.</p>
<p>Here is a <a href="https://stanford.edu/~shervine/teaching/cs-229/cheatsheet-machine-learning-tips-and-tricks">Machine Learning tips and tricks</a> and <a href="https://stanford.edu/~shervine/teaching/cs-230/cheatsheet-deep-learning-tips-and-tricks">Deep Learning Tips and Tricks</a> that I find useful.</p>
<section id="solve-a-problem-with-data-preprocessing" class="level4">
<h4 class="anchored" data-anchor-id="solve-a-problem-with-data-preprocessing">Solve a problem with data preprocessing</h4>
<p>This in my opinion the most powerful tips and tricks that I want to hightlight. As you can see from the example, an image recognizer is very handy when it comes to image classification task.</p>
<p>But can it tackle something that is not related to an image? — Actually it can and it can do it pretty well too.</p>
<p>For instance, a sound can be converted to a spectrogram, which is a chart that shows the amount of each frequency at each time in an audio file. Fast.ai student Ethan Sutin used this approach to easily beat the published accuracy of a state-of-the-art <a href="https://medium.com/@etown/great-results-on-audio-classification-with-fastai-library-ccaf906c5f52">environmental sound detection model</a> using a dataset of 8,732 urban sounds. fastai’s <code>show_batch</code> clearly shows how each different sound has a quite distinctive spectrogram</p>
<p><img alt="show_batch with spectrograms of sounds" width="400" caption="show_batch with spectrograms of sounds" id="img_spect" src="https://github.com/fastai/fastbook/blob/master/images/att_00012.png?raw=1"></p>
<p>A time series can easily be converted into an image by simply plotting the time series on a graph. However, it is often a good idea to try to represent your data in a way that makes it as easy as possible to pull out the most important components. In a time series, things like seasonality and anomalies are most likely to be of interest. There are various transformations available for time series data. For instance, fast.ai student Ignacio Oguiza created images from a time series dataset for olive oil classification, using a technique called Gramian Angular Difference Field (GADF). He then fed those images to an image classification model just like the one you see in this chapter. His results, despite having only 30 training set images, were well over 90% accurate, and close to the state of the art.</p>
<p><img alt="Converting a time series into an image" width="700" caption="Converting a time series into an image" id="ts_image" src="https://github.com/fastai/fastbook/blob/master/images/att_00013.png?raw=1"></p>
<p>It change our way of thinking as well. It shows that:</p>
<blockquote class="blockquote">
<p>Deep learning is very powerful tool for you to use, you just need to find a way to properly represent your data to it</p>
</blockquote>
<p>Note that some techniques require only intuition of the data like an environmental sound detection model. However, some demands more in-depth methods to handle the data such as a olive oil classification. Someone might refer to it as “hacky workarounds”.</p>
</section>
<section id="biases-in-dataset" class="level4">
<h4 class="anchored" data-anchor-id="biases-in-dataset">Biases in Dataset</h4>
<p>There are several ways that you can do that makes your project getting a bias result. Most parts come from the way you handle your data.</p>
<section id="data-collection" class="level5">
<h5 class="anchored" data-anchor-id="data-collection">Data collection</h5>
<p>The first process that you can give a bias to your data is when you are collecting them. Generally speaking, we’ve seen that most organizations that say they don’t have enough data, actually mean they don’t have enough <em>labeled</em> data. So, they need to gather it.</p>
<p>I want to pause here a bit. As datasets is very critical to the model like a food. So, throughout the course, think about where the dataset might have come from, and how they might have been curated. Then think about what kinds of interesting datasets you could create for your own projects. Trust me, this will also be a valuable skill for you as a practitioner.</p>
<p>Back to business, Gathering data might create what so called <em>feedback loops</em>, as describe here:</p>
<ul>
<li>A <em>predictive policing</em> model is created based on where arrests have been made in the past. In practice, this is not actually predicting crime, but rather predicting arrests, and is therefore partially simply reflecting biases in existing policing processes.</li>
<li>Law enforcement officers then might use that model to decide where to focus their police activity, resulting in increased arrests in those areas.</li>
<li>Data on these additional arrests would then be fed back in to retrain future versions of the model.</li>
</ul>
<p>This is a <em>positive feedback loop</em>, where the more the model is used, the more biased the data becomes, making the model even more biased, and so forth.</p>
<p>Feedback loops can also create problems in commercial settings. For instance, a video recommendation system might be biased toward recommending content consumed by the biggest watchers of video (e.g., conspiracy theorists and extremists tend to watch more online video content than the average), resulting in those users increasing their video consumption, resulting in more of those kinds of videos being recommended. We’ll consider this topic more in detail in the later chapter about ethics.</p>
</section>
<section id="validation-set-and-test-set" class="level5">
<h5 class="anchored" data-anchor-id="validation-set-and-test-set">Validation Set and Test Set</h5>
<p>In practice, what you want to do really is making your model working for others. Therefore, validation and evaluation your model are the important steps as well as training which if you have done it properly, we are one step closer to your goal!</p>
<p>To do this, our first step was to split our dataset into two sets: the <em>training set</em> (which our model sees in training) and the <em>validation set</em>, also known as the <em>development set</em> (which is used only for evaluation). This lets us test that the model learns lessons from the training data that generalize to new data, the validation data.</p>
<p>One way to understand this situation is that, in a sense, we don’t want our model to get good results by “cheating.” If it makes an accurate prediction for a data item, that should be because it has learned characteristics of that kind of item, and not because the model has been shaped by <em>actually having seen that particular item</em>.</p>
<p>Splitting off our validation data means our model never sees it in training and so is completely untainted by it, and is not cheating in any way. Right?</p>
<p>In fact, not necessarily. The situation is more subtle. This is because in realistic scenarios we rarely build a model just by training its weight parameters once. Instead, we are likely to explore many versions of a model through various modeling choices regarding network architecture, learning rates, data augmentation strategies, and other factors we will discuss in upcoming chapters. Many of these choices can be described as choices of <em>hyperparameters</em>. The word reflects that they are parameters about parameters, since they are the higher-level choices that govern the meaning of the weight parameters.</p>
<p>The problem is that even though the ordinary training process is only looking at predictions on the training data when it learns values for the weight parameters, the same is not true of us. We, as modelers, are evaluating the model by looking at predictions on the validation data when we decide to explore new hyperparameter values! So subsequent versions of the model are, indirectly, shaped by us having seen the validation data. Just as the automatic training process is in danger of overfitting the training data, we are in danger of overfitting the validation data through human trial and error and exploration.</p>
<p>The solution to this conundrum is to introduce another level of even more highly reserved data, the <em>test set</em>. Just as we hold back the validation data from the training process, we must hold back the test set data even from ourselves. It cannot be used to improve the model; it can only be used to evaluate the model at the very end of our efforts. In effect, we define a hierarchy of cuts of our data, based on how fully we want to hide it from training and modeling processes: training data is fully exposed, the validation data is less exposed, and test data is totally hidden. This hierarchy parallels the different kinds of modeling and evaluation processes themselves—the automatic training process with back propagation, the more manual process of trying different hyper-parameters between training sessions, and the assessment of our final result.</p>
<p>The test and validation sets should have enough data to ensure that you get a good estimate of your accuracy. If you’re creating a cat detector, for instance, you generally want at least 30 cats in your validation set. That means that if you have a dataset with thousands of items, using the default 20% validation set size may be more than you need. On the other hand, if you have lots of data, using some of it for validation probably doesn’t have any downsides.</p>
<p>Having two levels of “reserved data”—a validation set and a test set, with one level representing data that you are virtually hiding from yourself—may seem a bit extreme. But the reason it is often necessary is because models tend to gravitate toward the simplest way to do good predictions (memorization), and we as fallible humans tend to gravitate toward fooling ourselves about how well our models are performing. The discipline of the test set helps us keep ourselves intellectually honest. That doesn’t mean we <em>always</em> need a separate test set—if you have very little data, you may need to just have a validation set—but generally it’s best to use one if at all possible.</p>
<p>This same discipline can be critical if you intend to hire a third party to perform modeling work on your behalf. A third party might not understand your requirements accurately, or their incentives might even encourage them to misunderstand them. A good test set can greatly mitigate these risks and let you evaluate whether their work solves your actual problem.</p>
<p>To put it bluntly, if you’re a senior decision maker in your organization (or you’re advising senior decision makers), the most important takeaway is this: if you ensure that you really understand what test and validation sets are and why they’re important, then you’ll avoid the single biggest source of failures we’ve seen when organizations decide to use AI. For instance, if you’re considering bringing in an external vendor or service, make sure that you hold out some test data that the vendor <em>never gets to see</em>. Then <em>you</em> check their model on your test data, using a metric that <em>you</em> choose based on what actually matters to you in practice, and <em>you</em> decide what level of performance is adequate. (It’s also a good idea for you to try out some simple baseline yourself, so you know what a really simple model can achieve. Often it’ll turn out that your simple model performs just as well as one produced by an external “expert”!)</p>
</section>
<section id="data-leakage" class="level5">
<h5 class="anchored" data-anchor-id="data-leakage">Data Leakage</h5>
<p>This is a very hard to detect problem as the name suggests. So, it easier to provide an example to you:</p>
<p>In the Kaggle <a href="https://www.kaggle.com/c/state-farm-distracted-driver-detection">distracted driver competition</a>, the independent variables are pictures of drivers at the wheel of a car, and the dependent variables are categories such as texting, eating, or safely looking ahead. Lots of pictures are of the same drivers in different positions. If you were an insurance company building a model from this data, note that you would be most interested in how the model performs on drivers it hasn’t seen before (since you would likely have training data only for a small group of people). In recognition of this, the test data for the competition consists of images of people that don’t appear in the training set.</p>
<p><img src="https://github.com/fastai/fastbook/blob/master/images/driver.PNG?raw=1" width="600" id="img_driver" caption="Two pictures from the training data" alt="Two pictures from the training data, showing the same driver"></p>
<p>If you put one of the images in your training set and one in the validation set, your model will have an easy time making a prediction for the one in the validation set, so it will seem to be performing better than it would on new people. Another perspective is that if you used all the people in training your model, your model might be overfitting to particularities of those specific people, and not just learning the states (texting, eating, etc.).</p>
<p>As you can see from the example, there is no single solution to this. So, keep in mind that</p>
<blockquote class="blockquote">
<p>Use Judgement in Defining Test Sets.</p>
</blockquote>
</section>
<section id="bias-and-variance-tradeoff" class="level5">
<h5 class="anchored" data-anchor-id="bias-and-variance-tradeoff">Bias and Variance Tradeoff</h5>
<p><img src="https://github.com/fastai/fastbook/blob/master/images/att_00000.png?raw=1" alt="Example of overfitting" caption="Example of overfitting" id="img_overfit" width="700"></p>
<p><strong>Overfitting is the single most important and challenging issue</strong> when training for all machine learning practitioners, and all algorithms. As you will see, it is very easy to create a model that does a great job at making predictions on the exact data it has been trained on, but it is much harder to make accurate predictions on data the model has never seen before. And of course, this is the data that will actually matter in practice. For instance, if you create a handwritten digit classifier and use it to recognize numbers written on checks, then you are never going to see any of the numbers that the model was trained on—checks will have slightly different variations of writing to deal with. You will learn many methods to avoid overfitting in this course.</p>
<p>However, you should only use those methods after you have confirmed that overfitting is actually occurring (i.e., you have actually observed the validation accuracy getting worse during training). We often see practitioners using over-fitting avoidance techniques even when they have enough data that they didn’t need to do so, ending up with a model that may be less accurate than what they could have achieved (i.e., <em>underfitting</em>)</p>
<blockquote class="blockquote">
<p>A good model is the one that can generalize well over underlying patterns in the data. Not the model that memorize everything!</p>
</blockquote>
</section>
<section id="prediction-is-not-a-recommendation" class="level5">
<h5 class="anchored" data-anchor-id="prediction-is-not-a-recommendation">Prediction Is Not a Recommendation</h5>
<p>Last, it is about the misconception of machine learning itself. In my opinion, it is very crucial for you as a practitioner to convey this message to all stakeholders involved in the project</p>
<blockquote class="blockquote">
<p>A model only creates predictions, not recommends actions.</p>
</blockquote>
</section>
</section>
</section>
</section>
<section id="deep-learning-is-not-just-for-image-classification" class="level2">
<h2 class="anchored" data-anchor-id="deep-learning-is-not-just-for-image-classification">Deep Learning Is Not Just for Image Classification</h2>
<p>Most examples usually in computer vision tasks. The reason is that it can be understand easily via a visual representation way of the problem. However, it is not necessary the case. Deep learning is far more valuabe and useful than that.</p>
<section id="image-segmentation" class="level3">
<h3 class="anchored" data-anchor-id="image-segmentation">Image Segmentation</h3>
<p>For instance, let’s talk about something that is critically important for autonomous vehicles: localizing objects in a picture. If a self-driving car doesn’t know where a pedestrian is, then it doesn’t know how to avoid one! Creating a model that can recognize the content of every individual pixel in an image is called <em>segmentation</em>. Here is how we can train a segmentation model with <code>fastai</code>, using a subset of the <a href="http://www0.cs.ucl.ac.uk/staff/G.Brostow/papers/Brostow_2009-PRL.pdf"><em>Camvid</em> dataset</a> from the paper “Semantic Object Classes in Video: A High-Definition Ground Truth Database” by Gabruel J. Brostow, Julien Fauqueur, and Roberto Cipolla:</p>
<div id="cell-39" class="cell" data-outputid="7964b278-d8cf-4eae-d0f9-d890e4a5b8db" data-execution_count="4">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.CAMVID_TINY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="2318336" class="" max="2314212" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.18% [2318336/2314212 00:00&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-40" class="cell" data-outputid="9614c272-9b8e-4ff5-f76a-ae52059d9972" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a glimpse of what an image looks like</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> PILImage.create(<span class="st">"/root/.fastai/data/camvid_tiny/images/0001TP_006750.png"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>img.to_thumb(<span class="dv">224</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<figure class="figure">
<p><img src="01-deep-learning-in-practice_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-41" class="cell" data-outputid="1a6a4663-513e-4bf4-d29a-47243914a7c8" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a glimpse of what a label looks like</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> PILImage.create(<span class="st">"/root/.fastai/data/camvid_tiny/labels/0001TP_006750_P.png"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>img.to_thumb(<span class="dv">224</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<figure class="figure">
<p><img src="01-deep-learning-in-practice_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A lable is quite hard to see though but there are hilights between each object in the image.</p>
<p>Next, we prepare <code>DataLoader</code> object like image classification task.</p>
<div id="cell-44" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> SegmentationDataLoaders.from_label_func(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    path, fnames<span class="op">=</span>get_image_files(path<span class="op">/</span><span class="st">"images"</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    label_func<span class="op">=</span><span class="kw">lambda</span> x: path<span class="op">/</span><span class="st">"labels"</span><span class="op">/</span><span class="ss">f"</span><span class="sc">{</span>x<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">_P</span><span class="sc">{</span>x<span class="sc">.</span>suffix<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    codes<span class="op">=</span>np.loadtxt(path<span class="op">/</span><span class="st">"codes.txt"</span>, dtype<span class="op">=</span><span class="bu">str</span>), bs<span class="op">=</span><span class="dv">8</span>, seed<span class="op">=</span><span class="dv">42</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to talk a little bit more about <code>SegmentationDataLoaders</code> and its method <code>from_label_func</code>. Basically, what this object will do is similar to <code>ImageDataLoaders</code>. So, I will focus on the method itself. According to the documentation, this method will create a <code>SegementationDataLoaders</code> from list of <code>fnames</code> in <code>path</code>s with <code>label_func</code>. The key is <code>label_func</code> here:</p>
<p>What it does is to return the an index from the each image filename. Those indicies will then be mapped with <code>codes</code> to be labels in each image.</p>
<p>Last, it our <code>bs</code> which stands for <em>batch size</em>. It is the number of sampling data that will be trained on SGD at a time.</p>
<p>Last, we train our <code>learner</code> in this case <code>unet_learner</code> which is a successful architecture for image segmentation task. We also provide <code>resnet</code> as a part of <code>unet</code> architecture.</p>
<div id="cell-47" class="cell" data-outputid="c43515c3-b04f-450a-cd29-28ec6c228ac5" data-execution_count="40">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> unet_learner(dls, resnet34)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.915763</td>
<td>2.578525</td>
<td>00:01</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.791474</td>
<td>1.675884</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.564460</td>
<td>1.348752</td>
<td>00:01</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.376029</td>
<td>1.171540</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.254213</td>
<td>1.017833</td>
<td>00:01</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.130328</td>
<td>0.951614</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.030382</td>
<td>0.845308</td>
<td>00:01</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.939838</td>
<td>0.822760</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.864249</td>
<td>0.814584</td>
<td>00:01</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.802218</td>
<td>0.800724</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.752931</td>
<td>0.790928</td>
<td>00:01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can visualize how well it achieved its task, by asking the model to color-code each pixel of an image. As you can see, it nearly perfectly classifies every pixel in every object. For instance, notice that all of the cars are overlaid with the same color and all of the trees are overlaid with the same color (in each pair of images, the lefthand image is the ground truth label and the right is the prediction from the model):</p>
<div id="cell-49" class="cell" data-outputid="79bb516e-942b-4906-8b47-2d77565904a9" data-execution_count="41">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>learn.show_results(max_n<span class="op">=</span><span class="dv">6</span>, figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01-deep-learning-in-practice_files/figure-html/cell-15-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sentiment-classification" class="level3">
<h3 class="anchored" data-anchor-id="sentiment-classification">Sentiment Classification</h3>
<p>One other area where deep learning has dramatically improved in the last couple of years is natural language processing (NLP). Computers can now generate text, translate automatically from one language to another, analyze comments, label words in sentences, and much more. Here is all of the code necessary to train a model that can classify the sentiment of a movie review better than anything that existed in the world just five years ago. We will use the <a href="https://ai.stanford.edu/~ang/papers/acl11-WordVectorsSentimentAnalysis.pdf">“IMDb Large Movie Review dataset”</a> from the paper “Learning Word Vectors for Sentiment Analysis” by Andrew Maas et al:</p>
<p>Like previous examples, we need to download dataset first.</p>
<div id="cell-52" class="cell" data-outputid="91909734-1f73-44f8-9641-e8461ffb5952" data-execution_count="43">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.IMDB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="144441344" class="" max="144440600" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [144441344/144440600 00:01&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-53" class="cell" data-outputid="f6fee717-d1b0-4f72-d02a-a9371dd68494" data-execution_count="57">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at some of positive reviews</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/root/.fastai/data/imdb/train/pos/5059_7.txt"</span>) <span class="im">as</span> f:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    txt <span class="op">=</span> f.read()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We viewed the vcr and found it to be fascinating. Not knowing anything about this true story, I thought: "Oh, no, P.Brosnan as an American Indian ('red' Indian in the film), what a bad choice" until I discovered the truth about Grey Owl. The film does a good job of demonstrating the dignity of these native peoples and undermining the racist myths about them. And Annie Galipeau, WOW, what a beauty, and very convincing as an Indian woman (I believe she is French-Canadian; she sure reverts to the all-too familiar speech of such). In spite, of Brosnan's detached, grunting style, in the end he comes through convincingly as a passionate, dedicated man. The plot is a little weak in demostrating his conversion from trapper to animal coservationist. Good film, highly recommended.</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-outputid="82016442-067f-4529-e101-2f808f4f29df" data-execution_count="60">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at some of negative reviews</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/root/.fastai/data/imdb/train/neg/7141_3.txt"</span>) <span class="im">as</span> f:</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    txt <span class="op">=</span> f.read()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Okay so I went into this movie not really expecting much I figured an action flick similar to The Fast and the Furious. Some nice cars some nice girls somewhat of a decent plot. Unfortunately I would have to say that this was probably the worst movie I have seen this year. Don't get me wrong the cars were nice and the girls were OK but the way they put the movie together was just plain crappy to put it nicely. The story just never made you care about the cast and the movie seemed just pieced together. So overall this movie was not the worst thing ever by far but if your looking for a movie to go to this weekend I would pass on this one for now.</code></pre>
</div>
</div>
<p>Next, let’s build <code>TextDataLoaders</code> using <code>from_folder</code> to create <em>imagenet</em> style dataset in <code>path</code> with <code>train</code> and <code>valid</code> subfolders (or provide <code>valid_pct</code>).</p>
<div id="cell-56" class="cell" data-outputid="e3f8af02-21ac-4752-e476-e6f7f7adad17" data-execution_count="61">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TextDataLoaders.from_folder(untar_data(URLs.IMDB), valid<span class="op">=</span><span class="st">'test'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<p>Note that we provide <code>valid</code> as “test” because of the folder name.</p>
<p>Last, using <code>text_classifier_learner</code> and <code>AWD_LSTM</code> architecture.</p>
<div id="cell-59" class="cell" data-outputid="0c528696-1082-4e54-8d95-99aa0e3a24d1" data-execution_count="62">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> text_classifier_learner(dls, AWD_LSTM, drop_mult<span class="op">=</span><span class="fl">0.5</span>, metrics<span class="op">=</span>accuracy)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">4</span>, <span class="fl">1e-2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="105070592" class="" max="105067061" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [105070592/105067061 00:01&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.461787</td>
<td>0.411839</td>
<td>0.810760</td>
<td>03:20</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.315260</td>
<td>0.248558</td>
<td>0.899240</td>
<td>06:39</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.231946</td>
<td>0.193859</td>
<td>0.924000</td>
<td>06:44</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.193754</td>
<td>0.186784</td>
<td>0.928080</td>
<td>06:40</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.144128</td>
<td>0.200959</td>
<td>0.925600</td>
<td>06:41</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are some options that I would like to point out. First, it is <code>drop_mult</code>. According to the documentation, it controls all the amount of “dropout” — a technique used to make the model more generalized, reducing the change of overfitting. Second, it is the value <code>1e-2</code>. This is “learning rate” which is a hyperparameter in SGD. Basically, it is like a step size of learning. The lower the value is, the slower training process is and hopefully more well-trained model received.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you ever have any questions about a fastai method, you should use the function <code>doc</code>, passing it the method name:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>doc(learn.predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Let’s move on to something much less sexy, but perhaps significantly more widely commercially useful: building models from plain <em>tabular</em> data.</p>
</section>
<section id="tabular-data" class="level3">
<h3 class="anchored" data-anchor-id="tabular-data">Tabular Data</h3>
<p>It is a type of data that is in the form of a table, such as from a spreadsheet, database, or CSV file. A tabular model is a model that tries to predict one column of a table based on information in other columns of the table.</p>
<p>Here is the code necessary to train a model that will predict whether a person is a high-income earner, based on their socioeconomic background:</p>
<div id="cell-62" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.ADULT_SAMPLE)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TabularDataLoaders.from_csv(path<span class="op">/</span><span class="st">'adult.csv'</span>, path<span class="op">=</span>path, y_names<span class="op">=</span><span class="st">"salary"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    cat_names <span class="op">=</span> [<span class="st">'workclass'</span>, <span class="st">'education'</span>, <span class="st">'marital-status'</span>, <span class="st">'occupation'</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'relationship'</span>, <span class="st">'race'</span>],</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    cont_names <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'fnlwgt'</span>, <span class="st">'education-num'</span>],</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    procs <span class="op">=</span> [Categorify, FillMissing, Normalize])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> tabular_learner(dls, metrics<span class="op">=</span>accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are various things to note: * <code>TabularDataLoaders</code> uses <code>from_csv</code> method to load data from downloaded <strong>adult.csv</strong> file. * <code>y_names</code> is for a target column * <code>cat_names</code> is for categorical features * <code>cont_names</code> is for continuous features * <code>procs</code> is the steps for pre-processing data before entering the model such as: * <code>Categorify</code> means categorical encoding: Convert categories into numerical representation * <code>Normalize</code> means “Normalization” — the technique to eliminate the unit aspect of numerical data</p>
<p>Last, since there is no pretrained model available for this task (in general, pretrained models are not widely available for any tabular modeling tasks, although some organizations have created them for internal use), so we don’t use <code>fine_tune</code> in this case. Instead we use <code>fit_one_cycle</code>, the most commonly used method for training <code>fastai</code> models <em>from scratch</em> (i.e.&nbsp;without transfer learning):</p>
<div id="cell-64" class="cell" data-outputid="a05459cc-4fa1-4db4-e682-9646372df38f" data-execution_count="66">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.391232</td>
<td>0.355708</td>
<td>0.837070</td>
<td>00:04</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.364654</td>
<td>0.343000</td>
<td>0.842598</td>
<td>00:05</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.358486</td>
<td>0.340704</td>
<td>0.846898</td>
<td>00:04</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This model is using the <a href="http://robotics.stanford.edu/~ronnyk/nbtree.pdf"><em>Adult</em> dataset</a>, from the paper “Scaling Up the Accuracy of Naive-Bayes Classifiers: a Decision-Tree Hybrid” by Rob Kohavi, which contains some demographic data about individuals (like their education, marital status, race, sex, and whether or not they have an annual income greater than $50k).</p>
</section>
<section id="recommendation-system" class="level3">
<h3 class="anchored" data-anchor-id="recommendation-system">Recommendation System</h3>
<p>Let’s look at one more. Recommendation systems are very important, particularly in e-commerce. Companies like Amazon and Netflix try hard to recommend products or movies that users might like. Here’s how to train a model that will predict movies people might like, based on their previous viewing habits, using the <a href="https://doi.org/10.1145/2827872">MovieLens dataset</a>:</p>
<div id="cell-67" class="cell" data-outputid="ed2632fe-5406-4577-9e26-090634a382a5" data-execution_count="68">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.ML_SAMPLE)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> CollabDataLoaders.from_csv(path<span class="op">/</span><span class="st">'ratings.csv'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> collab_learner(dls, y_range<span class="op">=</span>(<span class="fl">0.5</span>,<span class="fl">5.5</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="57344" class="" max="51790" style="width:300px; height:20px; vertical-align: middle;"></progress>
      110.72% [57344/51790 00:00&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.504237</td>
<td>1.424283</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.373108</td>
<td>1.367214</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.271707</td>
<td>1.195855</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.038150</td>
<td>0.891961</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.809098</td>
<td>0.742112</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.688838</td>
<td>0.704049</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>0.646945</td>
<td>0.690868</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.626341</td>
<td>0.685442</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.604875</td>
<td>0.683328</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.606573</td>
<td>0.682748</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.600661</td>
<td>0.682595</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This model is predicting movie ratings on a scale of 0.5 to 5.0 to within around 0.6 average error. Since we’re predicting a continuous number, rather than a category, we have to tell <code>fastai</code> what range our target has, using the <code>y_range</code> parameter.</p>
<p>Although we’re not actually using a pretrained model (for the same reason that we didn’t for the tabular model), this example shows that fastai lets us use <code>fine_tune</code> anyway in this case. Sometimes it’s best to experiment with <code>fine_tune</code> versus <code>fit_one_cycle</code> to see which works best for your dataset.</p>
<p>We can use the same <code>show_results</code> call we saw earlier to view a few examples of user and movie IDs, actual ratings, and predictions:</p>
<div id="cell-70" class="cell" data-outputid="b037851d-6c1d-4634-b974-faeaaf5659bb" data-execution_count="69">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>learn.show_results()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">userId</th>
<th data-quarto-table-cell-role="th">movieId</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">rating_pred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.0</td>
<td>80.0</td>
<td>4.0</td>
<td>4.326948</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>79.0</td>
<td>58.0</td>
<td>5.0</td>
<td>4.278591</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>36.0</td>
<td>15.0</td>
<td>4.0</td>
<td>4.152308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>76.0</td>
<td>65.0</td>
<td>4.0</td>
<td>3.322256</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>17.0</td>
<td>20.0</td>
<td>5.0</td>
<td>4.176706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>65.0</td>
<td>80.0</td>
<td>4.5</td>
<td>3.973742</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>74.0</td>
<td>25.0</td>
<td>3.0</td>
<td>3.568486</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>43.0</td>
<td>26.0</td>
<td>4.0</td>
<td>3.550551</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>99.0</td>
<td>15.0</td>
<td>4.5</td>
<td>4.204627</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="questionnaire" class="level2">
<h2 class="anchored" data-anchor-id="questionnaire">Questionnaire</h2>
<p>All the answers are in the text of the chapter of <a href="https://course.fast.ai/Resources/book.html">the book</a>, so if you’re not sure about anything here, reread that part of the text and make sure you understand it.</p>
<p>For more questions, including detailed answers and links to the video timeline, have a look at Radek Osmulski’s <a href="http://aiquizzes.com/howto">aiquizzes</a>.</p>
<ol type="1">
<li>Do you need these for deep learning?
<ul>
<li>Lots of math T/F</li>
<li>Lots of data T/F</li>
<li>Lots of expensive computers T/F</li>
<li>A PhD T/F</li>
</ul></li>
</ol>
<details>
<summary>
Solution
</summary>
<ul>
<li>Lots of math: F</li>
<li>Lots of data: F</li>
<li>Lots of expensive computers: F</li>
<li>A PhD: F</li>
</ul>
</details>
<ol start="2" type="1">
<li>Name five areas where deep learning is now the best in the world.</li>
</ol>
<details>
<summary>
Solution
</summary>
<ul>
<li>Games: Playing Go and Starcraft</li>
<li>NLP: LLMs — a large language model capable of predicting the next word</li>
<li>Computer Vision: Image classification like <em>AlexNet</em></li>
<li>Generative AI: Image generation and video generation</li>
<li>Recommendation Systems: Movie recommendation</li>
</ul>
</details>
<ol start="3" type="1">
<li>What was the name of the first device that was based on the principle of the artificial neuron?f</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>The Mark I Perceptron</p>
</details>
<ol start="4" type="1">
<li>Based on the book of the same name, what are the requirements for parallel distributed processing (PDP)?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="1">
<li>A set of <em>processing units</em></li>
<li>A <em>state of activation</em></li>
<li>An <em>output function</em> for each unit</li>
<li>A <em>pattern of connectivity</em> among units</li>
<li>A <em>propagation rule</em> for propagating patterns of activities through the network of connectivities</li>
<li>An <em>activation rule</em> for combining the inputs impinging on a unit with the current state of that unit to produce an output for the unit</li>
<li>A <em>learning rule</em> whereby patterns of connectivity are modified by experience</li>
<li>An <em>environment</em> within which the system must operate</li>
</ol>
</details>
<ol start="5" type="1">
<li>What were the two theoretical misunderstandings that held back the field of neural networks?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>The first one is the failure of the NN to handle simple XOR operation on a single layer and the second one is the statement which state that one extra layer of NN can solve any problem but it is slower and impossible to be useful in practice.</p>
</details>
<ol start="6" type="1">
<li>What is a GPU?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>GPU stands for Graphical Processing Unit. It is vital for training a deep learning model due to its parallelized nature of computation.</p>
</details>
<ol start="7" type="1">
<li>Open a notebook and execute a cell containing: <code>1+1</code>. What happens?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>2</p>
</details>
<ol start="8" type="1">
<li>Follow through each cell of the stripped version of the notebook for this chapter. Before executing each cell, guess what will happen.</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>All done through this documenation!</p>
</details>
<ol start="9" type="1">
<li>Complete the Jupyter Notebook online appendix.</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>All done through this documenation and experimentation!</p>
</details>
<ol start="10" type="1">
<li>Why is it hard to use a traditional computer program to recognize images in a photo?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>In traditional programming, you need to give a step-by-step instruction to program an application what to behave. On the other hand, Machine learning gives a computer ability to learn without being explicitly programmed.</p>
</details>
<ol start="11" type="1">
<li>What did Samuel mean by “weight assignment”?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>A process to determine the model parameters. Those weights at the end of the day need to give the model ability to complete a task. In other words, it needs to successfully transform inputs to outputs as intended.</p>
</details>
<ol start="12" type="1">
<li>What term do we normally use in deep learning for what Samuel called “weights”?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Model parameters</p>
</details>
<ol start="13" type="1">
<li>Draw a picture that summarizes Samuel’s view of a machine learning model.</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Refer to the <a href="../../lectures/dl-in-practice/01-deep-learning-in-practice.html#what-is-machine-learning">a complete process of machine learning</a>.</p>
</details>
<ol start="14" type="1">
<li>Why is it hard to understand why a deep learning model makes a particular prediction?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Due to its non-linearity behaviour from various functions from each node together with its deep architecture that makes those functions even more complex.</p>
</details>
<ol start="15" type="1">
<li>What is the name of the theorem that shows that a neural network can solve any mathematical problem to any level of accuracy?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Universal Approximation Theorem</p>
</details>
<ol start="16" type="1">
<li>What do you need in order to train a model?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ul>
<li>Dataset</li>
<li>Pretrained-model</li>
<li>GPU</li>
</ul>
</details>
<ol start="17" type="1">
<li>How could a feedback loop impact the rollout of a predictive policing model?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>If biases was made to a dataset and we keep using that dataset to train our model. Then, using our predictions from that model to train the model. It is likely to deviate from the truth. In this case:</p>
<ul>
<li>A <em>predictive policing</em> model is created based on where arrests have been made in the past. In practice, this is not actually predicting crime, but rather predicting arrests, and is therefore partially simply reflecting biases in existing policing processes.</li>
<li>Law enforcement officers then might use that model to decide where to focus their police activity, resulting in increased arrests in those areas.</li>
<li>Data on these additional arrests would then be fed back in to retrain future versions of the model which eventually creating a feedback loop.</li>
</ul>
</details>
<ol start="18" type="1">
<li>Do we always have to use 224×224-pixel images with the cat recognition model?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>No, we don’t. 224x224 size is just a standard size for historical reason as the old pretrained model needs this size exactly. Nowadays, we can pretty much use any size of an image to feed into the model because <code>item_tfms</code> will then resize it to be matched with the model input.</p>
</details>
<ol start="19" type="1">
<li>What is the difference between classification and regression?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>They are both supervised-type machine learning models. The key difference is <strong>classification</strong> is for predicting categorical values like whether an image is a cat or a dog. In contrast, <strong>regression</strong> is something for estimating numerical values like a price of a car from various attributes such as colors and car models.</p>
</details>
<ol start="20" type="1">
<li>What is a validation set? What is a test set? Why do we need them?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Validation set is a portion of your dataset used to test the performance of the training process of the model such as model parameter evaluation and hyperparameter evaluation. This set also known as “Development Set”.</p>
<p>Test set is another held-out dataset. We keep it from ourselves in order to eliminate biases during the iterative development process. This set will help ensure that our model actually generalize well on new dataset despite our own choices of hyperparameters.</p>
</details>
<ol start="21" type="1">
<li>What will fastai do if you don’t provide a validation set?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>automatically set it to 20% of all dataset you have.</p>
</details>
<ol start="22" type="1">
<li>Can we always use a random sample for a validation set? Why or why not?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>We can’t. The reason is that dataset has its own physical meaning. Consider time-series dataset, if we split data randomly, it will be strange for us to train on the data such as from 25-Dec to 31-Dec and use it to predict on 10-Nov.&nbsp;But it is not necessary the case, some dataset like diabetes classification may be able to split randomly (if we ensure the variety of each patient).</p>
</details>
<ol start="23" type="1">
<li>What is overfitting? Provide an example.</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>Overfiiting is a situation where a model can memorize all training samples and can not generalize well on the new dataset. For example, samples with roughly polynomial relationship. If you provide a model to have a this kind of relationship, in practice the model should perform well. However, if you train the model until overfitting occurs, instead of learning a relationship, the model will try to connect all samples together in other words memorize all patterns that it have seen. As a result, when a new data comes in, it can perform very bad due to overfitting situation.</p>
</details>
<ol start="24" type="1">
<li>What is a metric? How does it differ from “loss”?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>A metric and loss is basically has the same goal which is to measure the performance of the model. The difference is that a metric is for human to quickly see if it is a good model and loss is for model optimization. Therefore, for a metric, the higher the value is, the more useful the model becomes. In contrast, for loss, the lower the value is, the more useful the model becomes.</p>
</details>
<ol start="25" type="1">
<li>How can pretrained models help?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>It helps save your effort, time and cost. First, effort to gather and label huge amount of data from scratch. Next, saving your training time, usually a pretrained offers you more accurate model and tends to train faster. Last, training a model requires GPU and it is expensive. Therefore, a pretrained model which ususualy does less training time (Thanks to transfer learning technique) can save a lot of money while you stil accomplish your goal.</p>
</details>
<ol start="26" type="1">
<li>What is the “head” of a model?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>It is the last part of the model. Usually, it is a part where weight changing and layer adding adapt to a similar task during fine tuning.</p>
</details>
<ol start="27" type="1">
<li>What kinds of features do the early layers of a CNN find? How about the later layers?</li>
</ol>
<details>
<summary>
Solution
</summary>
CNN or Convolutional Neural Network learns basic features in the early layers such as colors and edges. In the latter layers, it will learn more complex features like an ear of a cat or a month of a dog.
</details>
<ol start="28" type="1">
<li>Are image models only useful for photos?</li>
</ol>
<details>
<summary>
Solution
</summary>
No really, it depends on how you shape your problem. If you can represent other data types into an image, you are good to go.
</details>
<ol start="29" type="1">
<li>What is an “architecture”?</li>
</ol>
<details>
<summary>
Solution
</summary>
An architecture is a term referring to a template of neural network structure. It acts as a starter form of the network before gaining weights through experience.
</details>
<ol start="30" type="1">
<li>What is segmentation?</li>
</ol>
<details>
<summary>
Solution
</summary>
Segmentation is a term used in image segmentation task (e.g., object detection). It is used for use-case like building an autonomous vehicle.
</details>
<ol start="31" type="1">
<li>What is <code>y_range</code> used for? When do we need it?</li>
</ol>
<details>
<summary>
Solution
</summary>
<code>y_range</code> is a parameter used in a technique callled “Collaborative Filtering”. It is used to define the range of values when predicting a numerical value in recommadation system.
</details>
<ol start="32" type="1">
<li>What are “hyperparameters”?</li>
</ol>
<details>
<summary>
Solution
</summary>
Hyperparameters are choices that used to tweak a model in a high level such as architectures or learning rate. They are important for improving the efficiency of your model and they are figured out by trial-and-error process.
</details>
<ol start="33" type="1">
<li>What’s the best way to avoid failures when using AI in an organization?</li>
</ol>
<details>
<summary>
Solution
</summary>
<p>In short, make sure that you do not fool yourself. The best way is to split the data into 3 set: Training set, Validation set and Test set. These dataset serve different purpose. The first and second ones are for training and model evaluation while you are developing your model. The last one is to ensure that your model is good to go in the production without any bias elsewhere.</p>
</details>
<p>For a complete solutions, See <a href="https://forums.fast.ai/t/fastbook-chapter-1-questionnaire-solutions-wiki/65647">Fastbook Chapter 1 Questionnaire Solutions</a></p>
<section id="further-research" class="level3">
<h3 class="anchored" data-anchor-id="further-research">Further Research</h3>
<ol type="1">
<li>Why is a GPU useful for deep learning? How is a CPU different, and why is it less effective for deep learning?</li>
</ol>
<details>
<summary>
Solution
</summary>
GPU is good in parallelism. It can do multiple and small computations at the same time. For example, displaying billion of pixel of a 4K-60FPS streaming video synchronously. Generally speaking, in deep learning we use its benefit to training the model faster by running SGD in batches to update set of weight in the architecture. The key difference to CPU is while GPU can handle small computations simultaneously, CPU does not. It is made to handle a complex task one at a time such as reading sets of instruction in a computer sequentially. Therefore, in deep learning which has small computations thousands of times to update weights, GPU is more suitable for this task as operations in the training process do not require any complex computation at all (They are just adding and multiplication of matrix!). Therefore, GPU should be the hardware of your choice when doing deep learning.
</details>
<ol start="2" type="1">
<li>Try to think of three areas where feedback loops might impact the use of machine learning. See if you can find documented examples of that happening in practice.</li>
</ol>
<details>
<summary>
Solution
</summary>
<ul>
<li>In human resources, let’s say you want to create a model that find talented candidates for an application. This is very hard problem in practice as most of the data come from the past which may not be diverse enough or have changed through era. Here is an example of <a href="https://www.theguardian.com/technology/2018/oct/10/amazon-hiring-ai-gender-bias-recruiting-engine">Amazon ditched AI recruiting tool that favored men for technical jobs</a> in practice.</li>
<li>In movie recommendation system, it highly depends on the user interaction which can lead to narrow sets of recommendations and limits your user experience.</li>
<li>In load approval systems, some features like races and social economic background can cause the machine to be bias over time as the model learns from those demographic data whether to approve for a load in the past.</li>
</ul>
</details>
<p>This notebook is adapted from <a href="https://nbviewer.org/github/fastai/fastbook/blob/master/01_intro.ipynb">Chapter 1 - Intro of Deep Learning for Coders with Fastai and PyTorch: AI Applications Without a PhD</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"20758989546a4aa2a7a6ebdedc449bff":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FileUploadModel","state":{"_counter":0,"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FileUploadModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"FileUploadView","accept":"","button_style":"","data":[],"description":"Upload","description_tooltip":null,"disabled":false,"error":"","icon":"upload","layout":"IPY_MODEL_4338bc549b1a44d682e701df68043786","metadata":[],"multiple":false,"style":"IPY_MODEL_2ca570ca7f044ea2a0820e95e30afdb1"}},"2ca570ca7f044ea2a0820e95e30afdb1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ButtonStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ButtonStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","button_color":null,"font_weight":""}},"4338bc549b1a44d682e701df68043786":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/green-nk\.github\.io\/practical-deep-learning\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lectures/dl-in-practice/01-pre-trained-model.html" class="pagination-link" aria-label="Is it a bird? — The power of pretrained-model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Is it a bird? — The power of pretrained-model</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../projects/horapa-vs-kaprao.html" class="pagination-link" aria-label="Is it actually holy basil?">
        <span class="nav-page-text">Is it actually holy basil?</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © 2024, Nakarin Korsuwan<br>
Made with <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/green-nk/practical-deep-learning" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>